<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="luggage, transport, flight, travel, packing, trip, airplane">
    <meta name="description" content="Wszystkie informacje o bagażu lotniczym w jednym miejscu!">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Informacje bagażowe</title>
    <link type="text/css" rel="stylesheet" href="/css/jquery-ui.css">
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script data-ad-client="ca-pub-1538658242858314" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link type="text/css" rel="stylesheet" href="/css/style.css">
    <style>
        .ui-autocomplete {
            max-height: 200px;
            overflow-y: scroll;
            overflow-x: hidden;
        }
    </style>
    <script>
        var mainTemp = ""
        var handTemp = ""
        var obj = {}
        $(document).ready(function () {

            $.ajax({
                url: "https://packyourbag.pl/getItemData",
                type: "POST",
                success: function (data) {
                    obj = JSON.parse(data)
                    areItemsReady = true
                    $("#search")
                        .autocomplete({
                            source: Object.keys(obj)
                        })
                        .on("focus", function () {
                            mainTemp = $("#mainCheck").attr("src")
                            handTemp = $("#handCheck").attr("src")
                            $("#mainCheck").attr("src", "https://thumbs.gfycat.com/FaintSpicyAnnashummingbird-small.gif")
                            $("#handCheck").attr("src", "https://thumbs.gfycat.com/FaintSpicyAnnashummingbird-small.gif")
                        })
                        .on("keydown", function (e) {
                            if (e.keyCode == 8 || e.keyCode == 46) {
                                mainTemp = $("#mainCheck").attr("src")
                                handTemp = $("#handCheck").attr("src")
                                $("#mainCheck").attr("src", "https://thumbs.gfycat.com/FaintSpicyAnnashummingbird-small.gif")
                                $("#handCheck").attr("src", "https://thumbs.gfycat.com/FaintSpicyAnnashummingbird-small.gif")
                            }
                        })
                        .on("blur", function () {
                            $("#mainCheck").attr("src", mainTemp)
                            $("#handCheck").attr("src", handTemp)
                        })
                },
                error: function (xhr, status, error) {
                    console.log(xhr);
                },
            });
            var textAppearing
            $(".warning").on("mouseover", function () {
                $(this).removeClass("warningBackSlideAnim")
                $(this).addClass("warningSlideAnim")
                $(this).css("background-image", "none")
                textAppearing = setTimeout(() => {
                    $(this).text("Wykaz ma charakter wyłącznie informacyjny i jego przeznaczeniem jest ułatwienie pasażerom odbycia podróży. Prosimy pamiętać, że operator kontroli dokonuje decyzji o dopuszczeniu przedmiotu na pokład i pasażer ponosi odpowiedzialność za swoje mienie.")
                }, 1000)
            })
            $(".warning").on("mouseout", function () {
                $(this).removeClass("warningSlideAnim")
                $(this).addClass("warningBackSlideAnim")
                clearInterval(textAppearing)
                $(this).empty()
                $(this).css("background-image", "url(https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/OOjs_UI_icon_info.svg/1200px-OOjs_UI_icon_info.svg.png)")

            })

        })
        var wasInSearch = false
        var searchedValue = ""
        var linkToAccepted = "/gfx/ok.png"
        var linkNotAccepted = "/gfx/x.png"
        var linkConditionally = "/gfx/warning.png"
        var areItemsReady = false
        var firstSearch = true

        function handle(e) {
            if (e.keyCode === 13) {
                e.preventDefault()
                sendEnteredPhrase()
            }
        }
        function sendEnteredPhrase() {
            if (areItemsReady) {
                var enteredPhrase = document.getElementById("search").value
                if (firstSearch) {
                    checkIfBanned(enteredPhrase)
                }
                else {
                    $("#main").addClass("colorChangeAnim")
                    $("#hand").addClass("colorChangeAnim")
                    setTimeout(() => {
                        checkIfBanned(enteredPhrase)
                    }, 500)
                    setTimeout(() => {
                        $("#main").removeClass("colorChangeAnim").removeClass("luggageAppearAnim")
                        $("#hand").removeClass("colorChangeAnim").removeClass("luggageAppearAnim")
                    }, 1000)
                }
            }
            else {
                alert("pliki nie gotowe")
            }
        }
        function checkIfBanned(enteredPhrase) {
            for (key in obj) {
                if (enteredPhrase.toLowerCase() == key.toLowerCase()) {
                    wasInSearch = true

                    if (obj[key].glowny) {
                        changePrompt("main", "accepted")
                    }
                    else {
                        changePrompt("main", "rejected")
                    }
                    if (obj[key].podreczny && obj[key].conditionally) {
                        changePrompt("hand", "conditionally")
                    }
                    else if (obj[key].podreczny) {
                        changePrompt("hand", "accepted")
                    }
                    else {
                        changePrompt("hand", "rejected")
                    }
                }
            }
            if (wasInSearch) {
                if (firstSearch) {
                    $(".warning").addClass('fadeOutAnim')
                    $("#navbar").addClass('topNavbar')
                    setTimeout(() => {
                        $("#luggage").css('display', 'flex')
                        $("#main").addClass("luggageAppearAnim")
                        $("#hand").addClass("luggageAppearAnim")
                        $(".warning").css("display", "none")
                    }, 1000)
                    firstSearch = false
                }
            }
            else {
                alert("Brak w bazie")
            }
            wasInSearch = false
        }
        function changePrompt(type, decision) {
            if (decision == "accepted") {
                document.getElementById(type).style.backgroundColor = "rgba(0,255,0,0.7)"
                document.getElementById(type + "Check").setAttribute("src", linkToAccepted)
                if (type == "hand") {
                    handTemp = linkToAccepted
                }
                else {
                    mainTemp = linkToAccepted
                }
                document.getElementById("handInfo").innerText = ""
            }
            else if (decision == "conditionally") {
                document.getElementById(type).style.backgroundColor = "rgba(255,255,0,0.7)"
                document.getElementById(type + "Check").setAttribute("src", linkConditionally)
                if (type == "hand") {
                    handTemp = linkConditionally
                }
                else {
                    mainTemp = linkConditionally
                }
                document.getElementById("handInfo").innerText = "Tylko w pojemnikach 100ml"
            }
            else {
                document.getElementById(type).style.backgroundColor = "rgba(255,0,0,0.7)"
                document.getElementById(type + "Check").setAttribute("src", linkNotAccepted)
                if (type == "hand") {
                    handTemp = linkNotAccepted
                }
                else {
                    mainTemp = linkNotAccepted
                }
                document.getElementById("handInfo").innerText = ""
            }
        }

    </script>
</head>

<body>
    <div id="infobar">
        <div class="warning"></div>
    </div>
    <div id="siteBody">


        <div id="navbar">
            <input onkeypress="handle(event)" id="search" type="text"
                placeholder="Co chcesz umieścić w swoim bagażu?" />
            <img id="enter" onclick="sendEnteredPhrase()" src="https://static.thenounproject.com/png/620845-200.png" />
            <div id="socialMedias">
                <a href="https://www.facebook.com/Packyourbag-109337594166249/?view_public_for=109337594166249"><img
                        src="https://cdn3.iconfinder.com/data/icons/capsocial-round/500/facebook-512.png" /></a>
                <a href="https://twitter.com/?lang=pl"><img
                        src="https://cdn1.iconfinder.com/data/icons/logotypes/32/circle-twitter-512.png" /></a>
            </div>
        </div>
        <div id="luggage">
            <div id="adLeft"></div>
            <div id="main">
                <h1>Bagaż Główny
                    <br>
                    Rejestrowany
                </h1>
                <img id="mainCheck" src="" />
                <p id="mainInfo"><br /></p>
            </div>
            <div id="adMid"></div>
            <div id="hand">
                <h1>Bagaż Podręczny
                    <br />
                    Kabinowy
                </h1>
                <img id="handCheck" src="" />
                <p id="handInfo">Tylko w pojemnikach, do pojemności 100 ml</p>
            </div>
            <div id="adRight"></div>
        </div>
    </div>
</body>

</html>